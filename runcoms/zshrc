# vim:syntax=zsh tabstop=2 expandtab shiftwidth=2 softtabstop=2
#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

if [ "${ZSHRC_DEBUG}" -eq 1 ]; then
    zmodload zsh/zprof
fi

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi


# Customize to your needs...

# Enable support of bash autocomplete functions in zsh.
# autoload -U bashcompinit && bashcompinit

#####################
# zsh keybinding
#####################

# bindkey → zsh’s way to map keys to widgets (functions that operate on the command line).
# viins = vi insert mode
# vicmd = normal mode

# bindkey -l will give you a list of existing keymap names.
# bindkey -M <keymap> will list all the bindings in a given keymap.
bindkey -M viins "^W"   backward-kill-word
bindkey -M viins "^A"   beginning-of-line
bindkey -M viins "^E"   end-of-line
bindkey -M viins "[B"   history-search-forward               # down arrow
bindkey -M viins "[A"   history-search-backward              # up arrow

if ! zstyle -t ":prezto:module:fzf" loaded 'yes' 'no'; then
	# already defined bu fzf module, redefining breaks fzf binding
  bindkey -M viins "^R"   history-incremental-search-backward  # ctrl-r
fi
#####################


function precmd () {print -Pn "\e]0;%n@%m: %~\a"}

function title ()
{
    export TITLE=$@
    precmd () {print -Pn "\e]0; ${TITLE}\a"}
}

function mkkdir ()
{
    local dir=$1
    mkdir -p ${dir}
    cd ${dir}
}

function dbase64 ()
{
    echo -n "$1" |base64 -d
}

## Aliases

alias tma="tmux att"
alias vim="vim -p"
alias vi=vim
alias bc="bc -l"

alias lll='exa -lgh  --time-style full-iso  --git --group-directories-first -a'
alias ll='exa -lgh  --time-style long-iso  --git --group-directories-first'
alias lls='exa -lgh  --time-style long-iso  --git --group-directories-first'
alias l="exa -lg"
alias l='exa -lgh  --time-style long-iso  --git --group-directories-first  --git-ignore'

alias now='echo $(date "+%Y-%m-%d")'
alias now2='echo $(date "+%Y%m%d%H%M%S")'
alias now3='echo $(date "+%H:%M:%S")'


# https://www.johnhawthorn.com/2012/09/vi-escape-delays/
# 10ms for key sequences
# Centieme de secondes
export KEYTIMEOUT=10

# Configure time format
export TIMEFMT=$'\n%E real,\t%U user,\t%S sys'

function pretty_display_number()
{
    LC_ALL=en_US.UTF-8 ; printf "%'.d\n" $@
}

if [ -f ~/.zshrc.extra ] ; then
    source ~/.zshrc.extra
fi
if [ -f ~/.zshrc.local ] ; then
    source ~/.zshrc.local
fi
if [ "${ZSHRC_DEBUG}" -eq 1 ]; then
    zprof
fi
